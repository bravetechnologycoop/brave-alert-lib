# OS
dist: xenial

# Language
language: node_js # node version specified in .nvmrc

# install dependencies
install:
  - npm install

# define environment variables
env:
  global:
    # TWILIO_SID_TEST (from https://www.twilio.com/console/voice/project/test-credentials)
    - secure: 'LQGmKLsk0VcGdt6OyE22FYN+S5ZnNGUNaURyTJZsts3uFoXuK1db3OeLS+xBRF4H1FVjgDtb9KosDwKeUANypbq6SjkhokBNw744WKe9I1gGFVbqh6A/Cpi8PnIj7E86eHsZ3ZNOY/NGZawMVIB9m5HwUaHoTywp08NyLx4ZyLFZ7KnfeJWXNnWiDFmOLHKT52Lm+3F5aZRQG2YsEyl4Zjd/Cbw1SNvuz9WG8Gq8UgsrTtx9eZ0OZhH/gy0SXHk+RCctIfXAbMcsirCzsomcy/N64Dl0QW92yq4eFhIdQrwvQEJWp3JoUDbTibjkWOoYitl1ebiAoDdQdcqvW+ZqxaM8wjMf81Vn56iEOTW+nVhMSpvVfG0664hHuASDI0GG5XcvEHzVBNAQsScDcK9ftN6/Vrbk3PLVc6aayuJviAzDCfkX687gnb+NA0IDlcZd0RMWEPoAXcoXAYM8T1l75E1vbVWF35LKAux5kmyTxDmToXTb50c3c9azmIWuYOJdSkdXI/B8/wvvZieElgSumoIuYLJm+vcwg0hMnxjyb5eVGCJFlYRcUEbzvtwtjAalpQT5xiB+k1FNh3YaR4VJ+T/qiix/CFtli2pUGG7mTj2uo5Y/64qyTne8ZqR/S3+lRo/t5pzf9Hi9seDAOiTlkDna0eYAas9bdKhwhPlLGtU='
    # TWILIO_TOKEN_TEST (from https://www.twilio.com/console/voice/project/test-credentials)
    - secure: 'FPm3qiQofYifPEXpfNEW9ETnU2zASy8l8H63Pt3DurMiuBHJpVJoKXbJeh8OE9UvVnEpZ9yYGkfWxoAQBywcoVEKfdhWgPzlvdBKEH5/Iz8EzGEBst1M1l3OGex/GZYsb8T43ldsdlcE5vLiMLNX8qv6fW/Ye0O66vKE7tebiGvDPXnyXgbCofXPBg5oES37n3E4mQapqas2RGucElQocDmk4BjqUw8KhwU2RzVRhg6qxDqHx116VEm9IsnpwqWl0YwoYzzzkY7jxrE/aCYkwJkufEdS9CxIt9ZXn+WSHBJncPL5HGxjJAwHE5CgPZDZe4ejpYmHW0DBRNGp5Qs6rXU9jVW85DDh582RNryuoqkNH4MGgVYXsesHzFcxlDbJ7VRH4l0GibWAVw4Lq5xoKiiiqW67felfglCENDdngnq8TM5KN8Nw7kDE2hH2yjbMiz3noBKwSIvoNCGJTsM+cKCnt5yCfSe1fgCzJPa8KO18plT6HRUw+dmDXF/yrquIi95UCB/wn4Y+TAosNbJoUE0RARhZNpJe7phDdoMXJI0CGNhzxcLiw3MHSpER1q42j777we2plLlVatbQvf44sVDvRap3J6fsHvfYEcJtgVPrB0LciZqizRIqe/NXunKTO0RRoTz6/QU2yaUmmBebthRuIG2rwb3q1jBFzHthI9w='
    # ONESIGNAL_APP_ID_TEST
    - secure: 'eFZh6/l+FN88cAiO8a8q4ASbFOHbW9XHESzYDzldPuxQ7gB5jmwyrUoEN7vuNsdJQpO4x2Sl2KiB2xK3x4cCnsVPAAmdz54w81AmiWl19RRJfoQIdxg4pBes4FKYuztEbnIHqApIiEqW7STwuUR4LSzx4ld258WCzDIIf0iNA5MyBXEaJaUqIL9janqid02blhhj2fsLSFB3AwdivWUm+U6BPyTkuAS7MaW7sJOpC2bBUGFTTcnOeyOQ+H90tqvLoH11u8baK10K3eE8uZIFvfj4ecEtcMPRAXgGHisddd6Fb2T99mHbsq0bzAuH4tuIg4njhm1R9L24nKtgywSZJdgsadwMLVLar3WGgJpkhx0qOf5dnMLvfXoJsbUbFCCFbKPnSpTN66iHF0dOuk39Vuviud8VxPyMw2twP7GiByZBsB5FPCh+OEa/WEHVkyCHlKzYpePhfyi37OHh5ZGTZKI/GYWpYvpGvNT0I0k/Ld9i8Jpq3rpHYWsG9UYC3+hneYkRaVAkaQaSJiMLyz7CO9SyB2azm+rpP3peINXzB+iJ4CdSolhpevEy8eJIS2J2vGuOCiGaxina8WIHlVVRr+kxknT2HDcJPr/cHbLC3YQT9jtSVO/X7OjTAKZwORvAF8fYIrAUMPYIVll13aRQ2byKliZQo0Nt9JjWFmSuOS0='
    # ONESIGNAL_API_KEY_TEST
    - secure: 'GQoG4T0VwR+04ce/NZ+3eONPDT9UV7hwXdIC1fyCJUlwNWliuBRxepIluf8i9OrnX9/GhoICNqHKp2Jwoo7nAvPwV6yCCAfSQAAI83zcHrJqyt8KmsePI/L44ZYqVvBKmkqXDPPz76WkbVZC/IOSfhJQbK1p6UIlMGifyJ/1KqpyVMsstDx1rezdx/G3bhweHbW+/Xr8vUWtno5pdp1zP5J//NCnhB2t0nNVE3ZrMV4LJEpKVSWpLM8kaB3dxSGnr9/51+G0Zhyl7O5yPldqHMWs7e2CvHsdwyapulGXTseloDgIU9aMGSHuyCwJnIQlZjsJSrApvnehKiTb+vV6DrsDcNaMURaOSJoHTDnuwZ64xdHcx0m4K4j36+AuYuJb/juJFwHS54j/Ejy9fH9Ijyxgqcs6Jh1+ge0F3pnoQK6csypySQI+mAIEABwiMnQdDVHjcmwWJ1yqD4RGFMiJoZ6qQQ5sQKhV6MCY3oc2iO7UFZvE6TqeiH24akuQ4d2X+hrjNgDoVwAXkJbpgvqtWuezv+mma/EKRrgH78rShnH+6SYUio/X4nEDCWdj1m1gth2ZNf0o0j+gI0JU4h5JLME/hBKieIcMM/iRJMFzRUPM0q4bmDgsIOYiAYUY8I0iO1rUtRdXgXwaK1mZx85B+woL3YkH9Zs+ChgNmoJiqvE='
    # TEST_ONESIGNAL_PUSH_ID_TEST
    - secure: 'EbghiGJhmmJCWKOcAbK9OTYjNokauIzOw6KWAvUXHUxGVYyQwrHyy7sePWhAv7yIxNFZUttWi36dl2/PJ+mUPsT02BJYDPFN41MCTQfV8JUP05gptv+vGHufCilRJppe4QYX2tf2v0gcGSxWNymjt5ZFAasLeVAn/0c3QmprJjWUSO1TWIPZHPLsjP5sTMr5UqcrIbrXDq+2NfSIXm0fDVbzfl/YDF8mZb/PNof2K8QaxofkB8b63HKALLqhbMGh8xx8Pz97932FWwTgtuj1VgENdv42VjkYcpicpnaqSm8Se9L/iFUkJ7qu4HroaRO992G9u3JEAiRKV2Ak+BZZGytwzPJ68l71+STB2sVq3PdL0OYSrQp3ZB4yNsRSQXZZrUUMTke+f7eu4AAZOSEfBqpESjsbxFDvcpxKFQxvcJ3OtAapj5re/nFpeicVZvU4PdCnelLlljaFNmFOWyOH0mUmnNOdnKnGCQPdL7/aPjJ0fbaK+Up9A0/z0XhKmnea5JQ5IpfSqQELji0oumz5pwfdE2Q78t7fJlCjCh/01CvFx/SJssSi47wK1SGYfsoe0fLtlrT5WRLlEyV2YYrBwRQjp2poNDBkngNJnEvZEOg76PV1xG4m/h6hzNYv1DN60Nu6Zh1URxzLDp3IkLBPnEaUx3pGuq7wfnEj0On6UmQ='

# Run security audit, linting, unit tests, and integration tests
script:
  - if [ "${TRAVIS_PULL_REQUEST}" != "false" ]; then npx audit-ci --config ./audit-ci.json; fi
  - npm run lint
  - sudo env "PATH=$PATH" npm run test
