# OS
dist: xenial

# Language
language: node_js # node version specified in .nvmrc

# install dependencies
install:
  - npm install

# define environment variables
env:
  global:
    # TWILIO_SID_TEST (from https://www.twilio.com/console/voice/project/test-credentials)
    - secure: 'LQGmKLsk0VcGdt6OyE22FYN+S5ZnNGUNaURyTJZsts3uFoXuK1db3OeLS+xBRF4H1FVjgDtb9KosDwKeUANypbq6SjkhokBNw744WKe9I1gGFVbqh6A/Cpi8PnIj7E86eHsZ3ZNOY/NGZawMVIB9m5HwUaHoTywp08NyLx4ZyLFZ7KnfeJWXNnWiDFmOLHKT52Lm+3F5aZRQG2YsEyl4Zjd/Cbw1SNvuz9WG8Gq8UgsrTtx9eZ0OZhH/gy0SXHk+RCctIfXAbMcsirCzsomcy/N64Dl0QW92yq4eFhIdQrwvQEJWp3JoUDbTibjkWOoYitl1ebiAoDdQdcqvW+ZqxaM8wjMf81Vn56iEOTW+nVhMSpvVfG0664hHuASDI0GG5XcvEHzVBNAQsScDcK9ftN6/Vrbk3PLVc6aayuJviAzDCfkX687gnb+NA0IDlcZd0RMWEPoAXcoXAYM8T1l75E1vbVWF35LKAux5kmyTxDmToXTb50c3c9azmIWuYOJdSkdXI/B8/wvvZieElgSumoIuYLJm+vcwg0hMnxjyb5eVGCJFlYRcUEbzvtwtjAalpQT5xiB+k1FNh3YaR4VJ+T/qiix/CFtli2pUGG7mTj2uo5Y/64qyTne8ZqR/S3+lRo/t5pzf9Hi9seDAOiTlkDna0eYAas9bdKhwhPlLGtU='
    # TWILIO_TOKEN_TEST (from https://www.twilio.com/console/voice/project/test-credentials)
    - secure: 'FPm3qiQofYifPEXpfNEW9ETnU2zASy8l8H63Pt3DurMiuBHJpVJoKXbJeh8OE9UvVnEpZ9yYGkfWxoAQBywcoVEKfdhWgPzlvdBKEH5/Iz8EzGEBst1M1l3OGex/GZYsb8T43ldsdlcE5vLiMLNX8qv6fW/Ye0O66vKE7tebiGvDPXnyXgbCofXPBg5oES37n3E4mQapqas2RGucElQocDmk4BjqUw8KhwU2RzVRhg6qxDqHx116VEm9IsnpwqWl0YwoYzzzkY7jxrE/aCYkwJkufEdS9CxIt9ZXn+WSHBJncPL5HGxjJAwHE5CgPZDZe4ejpYmHW0DBRNGp5Qs6rXU9jVW85DDh582RNryuoqkNH4MGgVYXsesHzFcxlDbJ7VRH4l0GibWAVw4Lq5xoKiiiqW67felfglCENDdngnq8TM5KN8Nw7kDE2hH2yjbMiz3noBKwSIvoNCGJTsM+cKCnt5yCfSe1fgCzJPa8KO18plT6HRUw+dmDXF/yrquIi95UCB/wn4Y+TAosNbJoUE0RARhZNpJe7phDdoMXJI0CGNhzxcLiw3MHSpER1q42j777we2plLlVatbQvf44sVDvRap3J6fsHvfYEcJtgVPrB0LciZqizRIqe/NXunKTO0RRoTz6/QU2yaUmmBebthRuIG2rwb3q1jBFzHthI9w='
    # ONESIGNAL_APP_ID_TEST
    - secure: 'ONSUeFe4dJppdfOQLB+OaTN2b9fnOy1YnHQ77Naf3dYBGN8fdEcF+tfA9o620lju2LsgtfUHrRPpsmAGkWbJNz82146t8MRgTMPVZc6GFFvwlR7ky2TV/uGM+4YbGVrnGjoe+3JD1qxHBS5JEDbcn1JTWOBgK2YcXho4x0t1q1zZmO38J8CMkAUlpD1J5t5mWPRqCLgNOHSAi8L1WWlVHzbMBvGIRohtxwe0WtNSn8dKKuIc1TLweA8+hguHJKqpRNOi4sVLpLlDJHqFh0uj1yuWa/dlY5YV6xB1jBFwaSKoid5sq0LCT26h5eB6+WwcsiXm6m6fmepPBqsDv//n48dZFDO7RbkJzTss5s4mTfI55YGRtM5AyBoA6Uj3IOZjzILyLgzzDEZwOsgHbWiPfrk+iv3BRJplDz/WtQOpA/WgLxdesz/httxDqmlT7dTQJoBE0Jnl2U2K4Fn0MQtUOniaScvES4pK1Gp0xF5kFteTB9VQatoGP5EnXvMu0hApYsX61j9E4r+JwC//wtXwIvOcRWJdhu2TAREHJRoaeUHfOM1RYfl4zDxbWUanhSEgIWFNJTA1GI2c1IJxmrzHFHGHMMG4j07UVKzT+9x7ZHhTlQZ8MUPDJRSShCeXBlnqaUhxqYh0iiFT5EADQj/Rn4/oeaqOXAFK5eknpfZ5Qks='
    # ONESIGNAL_API_KEY_TEST
    - secure: 'VTNWw0kTNJfOtoARTxzvo6mUrdfY1AtZ2PGYEdssYWI5GN4R1cBi9/RjGZa05FHXGjxDGu1lImLcK+LGwaRwrCTwa7gnbJoJ3rJZuqnREoHpHPKEBvg4+Kom/T/ti6/IFa0t/Qv5/99vtvF3+Og1fzmmWvHxNUvBNlOLWLC0XhY8dRkGcUFf5wcHhas4KSVatElC8alz7NoRt3G+RUYX+amcquzXvIcxicjEEWy/vXzXrn5WuTDDE/MLaXrGjDzJTcfTcG7sBStPrwZI/j9c2BX4POu7XSycfR971tzXe3HR8AwwNJQUUJBhSZIMVplWO8eWyUWNoXbyBp711h5/h7xlfy943xHlu1pzSnaK3rZbLZM8zhXUuipcG8L89/GAvCwPlY774AhsCiGgqo32sociXfGRhEee9JPkKVzpe+UMv6GRe1/h07gr2yd/5bOv9ia65RBkrCFAb/7BuO7V6y71JY4NhOC/LewOGxAwj5iH3V9dZpEs5NaF1r5gsU9j4QWE8e+Vjsk8YWt4cV4dWMbuJNEvcZ2OQXQS9U8bnXFTEhW+RSePRI+xDabjTMsfSQ87dl5JDs1s21F1X8UzEy62bCze15AMKVGR/4tJQgGvxeWkbvKsDMp7pAXORFbzgwmMk0NMkFfIIro7U6kgB3btHTf4BsuspML2nEo8stQ='
    # TEST_ONESIGNAL_PUSH_ID_TEST
    - secure: 'EbghiGJhmmJCWKOcAbK9OTYjNokauIzOw6KWAvUXHUxGVYyQwrHyy7sePWhAv7yIxNFZUttWi36dl2/PJ+mUPsT02BJYDPFN41MCTQfV8JUP05gptv+vGHufCilRJppe4QYX2tf2v0gcGSxWNymjt5ZFAasLeVAn/0c3QmprJjWUSO1TWIPZHPLsjP5sTMr5UqcrIbrXDq+2NfSIXm0fDVbzfl/YDF8mZb/PNof2K8QaxofkB8b63HKALLqhbMGh8xx8Pz97932FWwTgtuj1VgENdv42VjkYcpicpnaqSm8Se9L/iFUkJ7qu4HroaRO992G9u3JEAiRKV2Ak+BZZGytwzPJ68l71+STB2sVq3PdL0OYSrQp3ZB4yNsRSQXZZrUUMTke+f7eu4AAZOSEfBqpESjsbxFDvcpxKFQxvcJ3OtAapj5re/nFpeicVZvU4PdCnelLlljaFNmFOWyOH0mUmnNOdnKnGCQPdL7/aPjJ0fbaK+Up9A0/z0XhKmnea5JQ5IpfSqQELji0oumz5pwfdE2Q78t7fJlCjCh/01CvFx/SJssSi47wK1SGYfsoe0fLtlrT5WRLlEyV2YYrBwRQjp2poNDBkngNJnEvZEOg76PV1xG4m/h6hzNYv1DN60Nu6Zh1URxzLDp3IkLBPnEaUx3pGuq7wfnEj0On6UmQ='

# Run security audit, linting, unit tests, and integration tests
script:
  - if [ "${TRAVIS_PULL_REQUEST}" != "false" ]; then npx audit-ci --config ./audit-ci.json; fi
  - npm run lint
  - sudo env "PATH=$PATH" npm run test
